# API REQUEST VALIDATOR

## Task
The HTTP service provided in this repository serves the following purposes:
- receiving requests generated by collector
- checking the validity of each request
- rejecting invalid requests
- counting and storing statistics per customer per hour

The service also provides
- an endpoint to get the statistics
  - for a specific customer 
  AND
  - a specific day
The response must also contain the total number of requests for that day.

Requests considered as invalid are:
* malformed JSON
* missing one or more fields
* with a customer ID not found in the database or for a customer which is disabled
* with a remote IP address which is in the blacklist
* with a user agent which is in the blacklist

## Usage
The code provided is a REST API and sqlite3 is used for the database. Sqlite3 was used because it provides a lightweight disk-based database that doesn’t require a separate server process and allows accessing the database using a nonstandard variant of the SQL query language. It’s also possible to prototype an application using [SQLite3](https://docs.python.org/3/library/sqlite3.html) and then port the code to a larger database such as PostgreSQL or Oracle.
### Requirements

To run this app, the installation of the used libraries is a prerequisite. It is recommended that the libraries are installed and the code is run through a virtual environment in order not to interfere with the system's libraries. Through the Ubuntu terminal, first check if virtualenv is installed by typing the following:
```bash
sudo apt-get install python3-venv
```
To create a virtual environment:
```bash
python3 -m venv request-validator
```
To activate the environment:
```bash
source request-validator/bin/activate 
```
Finally the requirements can be installed using:
```bash
pip install -r requirements.txt
```
### Running the App
To run this service, first clone this repository then go to the directory of the cloned repository on your machine. Afterwards run:
```bash
python run.py
```
This should prompt a URL in the running terminal.
### Running inside a container with Docker
Since this service is dockerized, it could be run in a container using docker through the following:
```bash
docker build -t <image name> .
docker run -it -p 8000:8000 <image name>:latest
```
### Testing 
For testing purposes, PostMan was used. In the images folder are screenshots of different test cases and their output.
Furthermore, the "test" folder contains a code that utilizes the library [unittest](https://docs.python.org/3/library/unittest.html) to run unit tests on several of the methods. These tests check if the methods are giving correct outputs and also reports how much time it took to run the tests. 

## References
- For the JSON validation, forms were used following the templates from [WTForms](https://wtforms.readthedocs.io/en/2.3.x/)
- For the database, [SQLite3](https://docs.python.org/3/library/sqlite3.html) was used
- For requests, I referred to the [requests](https://requests.readthedocs.io/en/master/user/quickstart/) documentation
- For Unit testing, the library [unittest](https://docs.python.org/3/library/unittest.html) was used
